# Render Environment Variables Configuration

## Set These in Render Dashboard

Navigate to: **Your Service → Settings → Environment Variables**

Copy and configure these variables:

```
DATABASE_URL
(Auto-generated by Render PostgreSQL instance - DO NOT modify)
Example: postgresql://username:password@host.render.com:5432/database?sslmode=require

SECRET_KEY
(Set to a strong random string for session encryption)
Example: your-random-secret-key-change-this-to-something-secure

FLASK_ENV
production

TRANSLATION_ENABLED
true

TRANSLATION_API_URL
https://api.libretranslate.de/translate

TRANSLATION_API_KEY
(Your API key from LibreTranslate)
(Leave empty to use MyMemory fallback - no key required but slower)
```

## Detailed Setup

### 1. DATABASE_URL (Auto-Generated by Render)

**What:** PostgreSQL connection string with SSL
**Example:** 
```
postgresql://user:pass@render-postgres.render.com:5432/blog_db?sslmode=require
```
**Set by:** Render automatically when you attach a PostgreSQL database
**Notes:** 
- Includes `sslmode=require` for secure connections
- App automatically adds this if missing
- Never hardcode in code!

### 2. SECRET_KEY (Required for Session Security)

**What:** Encryption key for Flask sessions and CSRF tokens
**Generate one:**
```bash
python -c "import secrets; print(secrets.token_hex(32))"
```
Output example: `a3f5b8c2d9e1f4a7b6c3d2e1f0a9b8c7d6e5f4a3b2c1d0e9f8a7b6c5d4e3f2`

**Set in Render:**
1. Go to Environment Variables
2. Key: `SECRET_KEY`
3. Value: Paste the generated string
4. Click Add

### 3. TRANSLATION_ENABLED (Optional, Default: true)

**What:** Enable/disable translation feature
**Set to:** `true` or `false`
**Why:** Can disable in production to reduce external API calls

### 4. TRANSLATION_API_URL (Optional)

**What:** LibreTranslate API endpoint
**Recommended value:** `https://api.libretranslate.de/translate`

**Alternatives:**
- Your own LibreTranslate server: `https://your-server.com/translate`
- Public instance: `https://libretranslate.de/translate`

**Note:** App will use MyMemory fallback if not configured

### 5. TRANSLATION_API_KEY (Optional)

**What:** API key for LibreTranslate (prevents rate limiting)
**Where to get:**
1. Visit https://libretranslate.com
2. Sign up for free account
3. Go to API dashboard
4. Copy your API key

**Set in Render:**
1. Environment Variables
2. Key: `TRANSLATION_API_KEY`
3. Value: Your API key
4. Click Add

**What if empty?**
- App automatically falls back to MyMemory API
- No API key needed but slower/less reliable
- Recommended to set for production

---

## Local Development (.env file)

For testing locally, create a `.env` file in project root:

```bash
# .env file (DO NOT COMMIT to Git)
DATABASE_URL=sqlite:///blog.db
SECRET_KEY=dev-secret-key-for-testing
FLASK_ENV=development
TRANSLATION_ENABLED=true
TRANSLATION_API_URL=https://api.libretranslate.de/translate
TRANSLATION_API_KEY=your_key_here_optional
```

Then run:
```bash
python app.py
```

**Important:** 
- `.env` is in `.gitignore` (won't be committed)
- Different values for local vs Render is OK
- Use strong SECRET_KEY on Render only

---

## Deployment Environment Variables Summary

| Variable | Required | Example | Notes |
|----------|----------|---------|-------|
| `DATABASE_URL` | ✅ Yes | `postgresql://...` | Auto-set by Render |
| `SECRET_KEY` | ✅ Yes | `a3f5b8...` | Generate with `secrets.token_hex()` |
| `FLASK_ENV` | ⚠️ Recommended | `production` | Auto-set to 'production' on Render |
| `TRANSLATION_ENABLED` | ❌ Optional | `true` | Defaults to `true` |
| `TRANSLATION_API_URL` | ❌ Optional | `https://api...` | Falls back to MyMemory if empty |
| `TRANSLATION_API_KEY` | ❌ Optional | Your key | Empty = use MyMemory (slower) |

---

## Step-by-Step: Configure Render Dashboard

1. **Go to Render Dashboard**
   - https://dashboard.render.com

2. **Select Your Service**
   - Click on your Flask Blog App service

3. **Go to Settings**
   - Click "Settings" tab at top

4. **Environment Variables**
   - Scroll to "Environment" section
   - Click "Add Environment Variable"

5. **Add Each Variable:**
   ```
   DATABASE_URL:         (If not auto-set, get from PostgreSQL instance)
   SECRET_KEY:           (Generate new secure key)
   FLASK_ENV:            production
   TRANSLATION_ENABLED:  true
   TRANSLATION_API_URL:  https://api.libretranslate.de/translate
   TRANSLATION_API_KEY:  (Your LibreTranslate API key - optional)
   ```

6. **Save Changes**
   - Render automatically redeploys with new env vars

7. **Monitor Logs**
   - Go to Logs tab
   - Look for: `App started with config=production`
   - Confirm no errors

---

## Verify Configuration After Deploy

```bash
# Check app is running
curl https://your-app.onrender.com/health
# Response: {"status":"ok"}

# Check app logs for config confirmation
# In Render dashboard: Logs tab
# Look for: "App started with config=production TRANSLATION_ENABLED=true"

# Test translation feature
# Visit your site and try translating some text
# Check logs for: "Translation initiated" or "MyMemory translation succeeded"
```

---

## Security Best Practices

✅ **DO:**
- Set strong `SECRET_KEY` (use `secrets.token_hex(32)`)
- Use HTTPS URLs only for APIs
- Store API keys in Render env vars (NOT in code)
- Rotate `SECRET_KEY` periodically

❌ **DON'T:**
- Hardcode `SECRET_KEY` in source code
- Commit `.env` file to Git
- Use simple passwords like "secret123"
- Share API keys publicly
- Use HTTP URLs for translation APIs

---

## Troubleshooting Env Vars

**Problem: App shows "SECRET_KEY not set" error**
- Solution: Add `SECRET_KEY` env var in Render dashboard
- Verify: Check Render logs for "App started"

**Problem: Translation always fails**
- Check: Is `TRANSLATION_ENABLED=true` set?
- Check: Is `TRANSLATION_API_URL` set correctly?
- Check: Render logs for "Translation" errors
- Try: Empty `TRANSLATION_API_KEY` to use MyMemory

**Problem: "PostgreSQL connection refused"**
- Check: Is `DATABASE_URL` set?
- Check: Is PostgreSQL instance running on Render?
- Verify: `sslmode=require` in DATABASE_URL

**Problem: After changing env vars, app doesn't reflect changes**
- Solution: Render redeploys automatically
- Wait 1-2 minutes and refresh
- Check logs: "App started" with new config
